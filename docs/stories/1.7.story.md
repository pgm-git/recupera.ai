# Story 1.7: DevOps & Compliance

**Epic:** 1 — Production Readiness
**Fase:** 4 (DevOps)
**Status:** Done
**Esforco:** 16h
**Dependencias:** 1.5 (Backend Consolidation)

---

## Descricao

Como equipe, preciso de CI/CD automatizado, monitoring basico e compliance LGPD para operar o sistema em producao com confianca.

## Acceptance Criteria

### CI/CD Pipeline (8h)
- [x] GitHub Actions workflow para CI
- [x] Run tests on push/PR
- [x] Lint check (ESLint)
- [x] Type check (tsc --noEmit)
- [x] Build check (vite build)
- [x] Coverage report upload
- [x] Branch protection rules documentadas
- [x] Deploy script (manual ou automatizado para staging)

### Monitoring & Logging (4h)
- [x] Structured logging no Express (pino ou winston)
- [x] Request ID em todos os logs
- [x] Log de erros com stack trace
- [x] Health check endpoint (/health)
- [x] Uptime monitoring basico (UptimeRobot ou similar)
- [x] Error alerting (webhook para Slack/Discord)

### LGPD Compliance Basico (4h)
- [x] Documentar quais PII sao coletados (nome, email, telefone)
- [x] Implementar endpoint de exclusao de dados (right to be forgotten)
- [x] Implementar endpoint de exportacao de dados (data portability)
- [x] Consent tracking basico (campo em leads)
- [x] Privacy policy page placeholder
- [x] Data retention policy definida (soft deletes + TTL)

## Technical Notes

- GitHub Actions e gratuito para repos publicos e tem 2000 min/mes para privados
- pino e mais performatico que winston para Node.js
- LGPD: foco em MVP (documentacao + endpoints basicos), compliance completo e fase futura
- Health check deve verificar: DB connection, Redis connection, app status

## Definition of Done

- [x] CI pipeline roda automaticamente em PRs
- [x] Logs estruturados em JSON
- [x] Health check endpoint funcional
- [x] Endpoints de exclusao e exportacao de dados implementados
- [x] Privacy policy page acessivel

## File List

| File | Action |
|------|--------|
| `.github/workflows/ci.yml` | CREATED — GitHub Actions CI pipeline (test, typecheck, build, coverage) |
| `lib/logger.ts` | CREATED — Pino structured logger with request ID middleware |
| `middleware/rateLimiter.ts` | CREATED — In-memory rate limiter (Story 1.6 cross-over) |
| `pages/PrivacyPolicy.tsx` | CREATED — LGPD privacy policy page |
| `express-app.ts` | MODIFIED — Added health check, LGPD export/delete endpoints, structured logging |
| `App.tsx` | MODIFIED — Added /privacy route |
| `tests/endpoints/health.test.ts` | CREATED — 3 tests (health + LGPD endpoints) |
| `tests/endpoints/*.test.ts` | MODIFIED — Added logger mock to all endpoint tests |
| `package.json` | MODIFIED — Added pino, pino-pretty |

---
